(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{321:function(t,e,r){var i,o,n,s;
/*!
 * Firepad is an open-source, collaborative code and text editor. It was designed
 * to be embedded inside larger applications. Since it uses Firebase as a backend,
 * it requires no server-side code and can be added to any web app simply by
 * including a couple JavaScript files.
 *
 * Firepad 0.0.0
 * http://www.firepad.io/
 * License: MIT
 * Copyright: 2014 Firebase
 * With code from ot.js (Copyright 2012-2013 Tim Baumann)
 */n=function(){(t=t||{}).utils={},t.utils.makeEventEmitter=function(t,e){t.prototype.allowedEvents_=e,t.prototype.on=function(t,e,r){this.validateEventType_(t),this.eventListeners_=this.eventListeners_||{},this.eventListeners_[t]=this.eventListeners_[t]||[],this.eventListeners_[t].push({callback:e,context:r})},t.prototype.off=function(t,e){this.validateEventType_(t),this.eventListeners_=this.eventListeners_||{};for(var r=this.eventListeners_[t]||[],i=0;i<r.length;i++)if(r[i].callback===e)return void r.splice(i,1)},t.prototype.trigger=function(t){this.eventListeners_=this.eventListeners_||{};for(var e=this.eventListeners_[t]||[],r=0;r<e.length;r++)e[r].callback.apply(e[r].context,Array.prototype.slice.call(arguments,1))},t.prototype.validateEventType_=function(t){if(this.allowedEvents_){for(var e=!1,r=0;r<this.allowedEvents_.length;r++)if(this.allowedEvents_[r]===t){e=!0;break}if(!e)throw new Error('Unknown event "'+t+'"')}}},t.utils.elt=function(e,r,i){var o=document.createElement(e);if("string"==typeof r)t.utils.setTextContent(o,r);else if(r)for(var n=0;n<r.length;++n)o.appendChild(r[n]);for(var s in i||{})o.setAttribute(s,i[s]);return o},t.utils.setTextContent=function(t,e){t.innerHTML="",t.appendChild(document.createTextNode(e))},t.utils.on=function(t,e,r,i){t.addEventListener?t.addEventListener(e,r,i||!1):t.attachEvent&&t.attachEvent("on"+e,r)},t.utils.off=function(t,e,r,i){t.removeEventListener?t.removeEventListener(e,r,i||!1):t.detachEvent&&t.detachEvent("on"+e,r)},t.utils.preventDefault=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},t.utils.stopPropagation=function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},t.utils.stopEvent=function(e){t.utils.preventDefault(e),t.utils.stopPropagation(e)},t.utils.stopEventAnd=function(e){return function(r){return e(r),t.utils.stopEvent(r),!1}},t.utils.trim=function(t){return t.replace(/^\s+/g,"").replace(/\s+$/g,"")},t.utils.stringEndsWith=function(t,e){for(var r="string"==typeof e?[e]:e,i=0;i<r.length;i++)if(e=r[i],-1!==t.indexOf(e,t.length-e.length))return!0;return!1},t.utils.assert=function(t,e){if(!t)throw new Error(e||"assertion error")},t.utils.log=function(){if("undefined"!=typeof console&&void 0!==console.log){for(var t=["Firepad:"],e=0;e<arguments.length;e++)t.push(arguments[e]);console.log.apply(console,t)}},(t=t||{}).TextOp=function(){var e=t.utils;function r(t){this.type=t,this.chars=null,this.text=null,this.attributes=null,"insert"===t?(this.text=arguments[1],e.assert("string"==typeof this.text),this.attributes=arguments[2]||{},e.assert("object"==typeof this.attributes)):"delete"===t?(this.chars=arguments[1],e.assert("number"==typeof this.chars)):"retain"===t&&(this.chars=arguments[1],e.assert("number"==typeof this.chars),this.attributes=arguments[2]||{},e.assert("object"==typeof this.attributes))}return r.prototype.isInsert=function(){return"insert"===this.type},r.prototype.isDelete=function(){return"delete"===this.type},r.prototype.isRetain=function(){return"retain"===this.type},r.prototype.equals=function(t){return this.type===t.type&&this.text===t.text&&this.chars===t.chars&&this.attributesEqual(t.attributes)},r.prototype.attributesEqual=function(t){for(var e in this.attributes)if(this.attributes[e]!==t[e])return!1;for(e in t)if(this.attributes[e]!==t[e])return!1;return!0},r.prototype.hasEmptyAttributes=function(){var t=!0;for(var e in this.attributes){t=!1;break}return t},r}(),(t=t||{}).TextOperation=function(){"use strict";var e=t.TextOp,r=t.utils;function i(){if(!this||this.constructor!==i)return new i;this.ops=[],this.baseLength=0,this.targetLength=0}function o(t){var e=t.ops;switch(e.length){case 1:return e[0];case 2:return e[0].isRetain()?e[1]:e[1].isRetain()?e[0]:null;case 3:if(e[0].isRetain()&&e[2].isRetain())return e[1]}return null}function n(t){return t.ops[0].isRetain()?t.ops[0].chars:0}return i.prototype.equals=function(t){if(this.baseLength!==t.baseLength)return!1;if(this.targetLength!==t.targetLength)return!1;if(this.ops.length!==t.ops.length)return!1;for(var e=0;e<this.ops.length;e++)if(!this.ops[e].equals(t.ops[e]))return!1;return!0},i.prototype.retain=function(t,r){if("number"!=typeof t||t<0)throw new Error("retain expects a positive integer.");if(0===t)return this;this.baseLength+=t,this.targetLength+=t,r=r||{};var i=this.ops.length>0?this.ops[this.ops.length-1]:null;return i&&i.isRetain()&&i.attributesEqual(r)?i.chars+=t:this.ops.push(new e("retain",t,r)),this},i.prototype.insert=function(t,r){if("string"!=typeof t)throw new Error("insert expects a string");if(""===t)return this;r=r||{},this.targetLength+=t.length;var i=this.ops.length>0?this.ops[this.ops.length-1]:null,o=this.ops.length>1?this.ops[this.ops.length-2]:null;return i&&i.isInsert()&&i.attributesEqual(r)?i.text+=t:i&&i.isDelete()?o&&o.isInsert()&&o.attributesEqual(r)?o.text+=t:(this.ops[this.ops.length-1]=new e("insert",t,r),this.ops.push(i)):this.ops.push(new e("insert",t,r)),this},i.prototype.delete=function(t){if("string"==typeof t&&(t=t.length),"number"!=typeof t||t<0)throw new Error("delete expects a positive integer or a string");if(0===t)return this;this.baseLength+=t;var r=this.ops.length>0?this.ops[this.ops.length-1]:null;return r&&r.isDelete()?r.chars+=t:this.ops.push(new e("delete",t)),this},i.prototype.isNoop=function(){return 0===this.ops.length||1===this.ops.length&&this.ops[0].isRetain()&&this.ops[0].hasEmptyAttributes()},i.prototype.clone=function(){for(var t=new i,e=0;e<this.ops.length;e++)this.ops[e].isRetain()?t.retain(this.ops[e].chars,this.ops[e].attributes):this.ops[e].isInsert()?t.insert(this.ops[e].text,this.ops[e].attributes):t.delete(this.ops[e].chars);return t},i.prototype.toString=function(){return(Array.prototype.map||function(t){for(var e=[],r=0,i=this.length;r<i;r++)e[r]=t(this[r]);return e}).call(this.ops,(function(t){return t.isRetain()?"retain "+t.chars:t.isInsert()?"insert '"+t.text+"'":"delete "+t.chars})).join(", ")},i.prototype.toJSON=function(){for(var t=[],e=0;e<this.ops.length;e++)this.ops[e].hasEmptyAttributes()||t.push(this.ops[e].attributes),"retain"===this.ops[e].type?t.push(this.ops[e].chars):"insert"===this.ops[e].type?t.push(this.ops[e].text):"delete"===this.ops[e].type&&t.push(-this.ops[e].chars);return 0===t.length&&t.push(0),t},i.fromJSON=function(t){for(var e=new i,o=0,n=t.length;o<n;o++){var s=t[o],a={};"object"==typeof s&&(a=s,s=t[++o]),"number"==typeof s?s>0?e.retain(s,a):e.delete(-s):(r.assert("string"==typeof s),e.insert(s,a))}return e},i.prototype.apply=function(t,e,i){if(e=e||[],i=i||[],t.length!==this.baseLength)throw new Error("The operation's base length must be equal to the string's length.");for(var o,n,s=[],a=0,h=0,c=this.ops,p=0,u=c.length;p<u;p++){var l=c[p];if(l.isRetain()){if(h+l.chars>t.length)throw new Error("Operation can't retain more characters than are left in the string.");for(s[a++]=t.slice(h,h+l.chars),o=0;o<l.chars;o++){var d=e[h+o]||{},f={};for(n in d)f[n]=d[n],r.assert(!1!==f[n]);for(n in l.attributes)!1===l.attributes[n]?delete f[n]:f[n]=l.attributes[n],r.assert(!1!==f[n]);i.push(f)}h+=l.chars}else if(l.isInsert())for(s[a++]=l.text,o=0;o<l.text.length;o++){var g={};for(n in l.attributes)g[n]=l.attributes[n],r.assert(!1!==g[n]);i.push(g)}else h+=l.chars}if(h!==t.length)throw new Error("The operation didn't operate on the whole string.");var y=s.join("");return r.assert(y.length===i.length),y},i.prototype.invert=function(t){for(var e=0,r=new i,o=this.ops,n=0,s=o.length;n<s;n++){var a=o[n];a.isRetain()?(r.retain(a.chars),e+=a.chars):a.isInsert()?r.delete(a.text.length):(r.insert(t.slice(e,e+a.chars)),e+=a.chars)}return r},i.prototype.compose=function(t){if(this.targetLength!==t.baseLength)throw new Error("The base length of the second operation has to be the target length of the first operation");function e(t,e,r){var i,o={};for(i in t)o[i]=t[i];for(i in e)r&&!1===e[i]?delete o[i]:o[i]=e[i];return o}for(var r,o=new i,n=this.clone().ops,s=t.clone().ops,a=0,h=0,c=n[a++],p=s[h++];void 0!==c||void 0!==p;)if(c&&c.isDelete())o.delete(c.chars),c=n[a++];else if(p&&p.isInsert())o.insert(p.text,p.attributes),p=s[h++];else{if(void 0===c)throw new Error("Cannot compose operations: first operation is too short.");if(void 0===p)throw new Error("Cannot compose operations: first operation is too long.");if(c.isRetain()&&p.isRetain())r=e(c.attributes,p.attributes),c.chars>p.chars?(o.retain(p.chars,r),c.chars-=p.chars,p=s[h++]):c.chars===p.chars?(o.retain(c.chars,r),c=n[a++],p=s[h++]):(o.retain(c.chars,r),p.chars-=c.chars,c=n[a++]);else if(c.isInsert()&&p.isDelete())c.text.length>p.chars?(c.text=c.text.slice(p.chars),p=s[h++]):c.text.length===p.chars?(c=n[a++],p=s[h++]):(p.chars-=c.text.length,c=n[a++]);else if(c.isInsert()&&p.isRetain())r=e(c.attributes,p.attributes,!0),c.text.length>p.chars?(o.insert(c.text.slice(0,p.chars),r),c.text=c.text.slice(p.chars),p=s[h++]):c.text.length===p.chars?(o.insert(c.text,r),c=n[a++],p=s[h++]):(o.insert(c.text,r),p.chars-=c.text.length,c=n[a++]);else{if(!c.isRetain()||!p.isDelete())throw new Error("This shouldn't happen: op1: "+JSON.stringify(c)+", op2: "+JSON.stringify(p));c.chars>p.chars?(o.delete(p.chars),c.chars-=p.chars,p=s[h++]):c.chars===p.chars?(o.delete(p.chars),c=n[a++],p=s[h++]):(o.delete(c.chars),p.chars-=c.chars,c=n[a++])}}return o},i.prototype.shouldBeComposedWith=function(t){if(this.isNoop()||t.isNoop())return!0;var e=n(this),r=n(t),i=o(this),s=o(t);return!(!i||!s||(i.isInsert()&&s.isInsert()?e+i.text.length!==r:!i.isDelete()||!s.isDelete()||r+s.chars!==e&&e!==r))},i.prototype.shouldBeComposedWithInverted=function(t){if(this.isNoop()||t.isNoop())return!0;var e=n(this),r=n(t),i=o(this),s=o(t);return!!(i&&s&&(i.isInsert()&&s.isInsert()?e+i.text.length===r||e===r:i.isDelete()&&s.isDelete()&&r+s.chars===e))},i.transformAttributes=function(t,e){var i,o={},n={},s={};for(i in t)s[i]=!0;for(i in e)s[i]=!0;for(i in s){var a=t[i],h=e[i];r.assert(null!=a||null!=h),null==a?n[i]=h:null==h?o[i]=a:a===h||(o[i]=a)}return[o,n]},i.transform=function(t,e){if(t.baseLength!==e.baseLength)throw new Error("Both operations have to have the same base length");for(var r=new i,o=new i,n=t.clone().ops,s=e.clone().ops,a=0,h=0,c=n[a++],p=s[h++];void 0!==c||void 0!==p;)if(c&&c.isInsert())r.insert(c.text,c.attributes),o.retain(c.text.length),c=n[a++];else if(p&&p.isInsert())r.retain(p.text.length),o.insert(p.text,p.attributes),p=s[h++];else{if(void 0===c)throw new Error("Cannot transform operations: first operation is too short.");if(void 0===p)throw new Error("Cannot transform operations: first operation is too long.");var u;if(c.isRetain()&&p.isRetain()){var l=i.transformAttributes(c.attributes,p.attributes);c.chars>p.chars?(u=p.chars,c.chars-=p.chars,p=s[h++]):c.chars===p.chars?(u=p.chars,c=n[a++],p=s[h++]):(u=c.chars,p.chars-=c.chars,c=n[a++]),r.retain(u,l[0]),o.retain(u,l[1])}else if(c.isDelete()&&p.isDelete())c.chars>p.chars?(c.chars-=p.chars,p=s[h++]):c.chars===p.chars?(c=n[a++],p=s[h++]):(p.chars-=c.chars,c=n[a++]);else if(c.isDelete()&&p.isRetain())c.chars>p.chars?(u=p.chars,c.chars-=p.chars,p=s[h++]):c.chars===p.chars?(u=p.chars,c=n[a++],p=s[h++]):(u=c.chars,p.chars-=c.chars,c=n[a++]),r.delete(u);else{if(!c.isRetain()||!p.isDelete())throw new Error("The two operations aren't compatible");c.chars>p.chars?(u=p.chars,c.chars-=p.chars,p=s[h++]):c.chars===p.chars?(u=c.chars,c=n[a++],p=s[h++]):(u=c.chars,p.chars-=c.chars,c=n[a++]),o.delete(u)}}return[r,o]},i.prototype.transform=function(t){return i.transform(this,t)},i}(),(t=t||{}).Cursor=function(){"use strict";function t(t,e){this.position=t,this.selectionEnd=e}return t.fromJSON=function(e){return new t(e.position,e.selectionEnd)},t.prototype.equals=function(t){return this.position===t.position&&this.selectionEnd===t.selectionEnd},t.prototype.compose=function(t){return t},t.prototype.transform=function(e){function r(t){for(var r=t,i=e.ops,o=0,n=e.ops.length;o<n&&(i[o].isRetain()?t-=i[o].chars:i[o].isInsert()?r+=i[o].text.length:(r-=Math.min(t,i[o].chars),t-=i[o].chars),!(t<0));o++);return r}var i=r(this.position);return this.position===this.selectionEnd?new t(i,i):new t(i,r(this.selectionEnd))},t}(),(t=t||{}).FirebaseAdapter=function(e){"undefined"==typeof firebase&&"function"!=typeof Firebase&&(firebase=r(2),r(13));var i=t.TextOperation,o=t.utils;function n(t,e,r){this.ref_=t,this.ready_=!1,this.firebaseCallbacks_=[],this.zombie_=!1,this.document_=new i,this.revision_=0,this.pendingReceivedRevisions_={};var o=this;if(e){this.setUserId(e),this.setColor(r);var n=t.root.child(".info/connected");this.firebaseOn_(n,"value",(function(t){!0===t.val()&&o.initializeUserData_()}),this),this.on("ready",(function(){o.monitorCursors_()}))}else this.userId_=t.push().key;setTimeout((function(){o.monitorHistory_()}),0)}function s(t,e){if(!t)throw new Error(e||"assertion error")}o.makeEventEmitter(n,["ready","cursor","operation","ack","retry"]),n.prototype.dispose=function(){var t=this;this.removeFirebaseCallbacks_(),this.handleInitialRevisions_=()=>{},this.ready_?(this.userRef_&&(this.userRef_.child("cursor").remove(),this.userRef_.child("color").remove()),this.ref_=null,this.document_=null,this.zombie_=!0):this.on("ready",(function(){t.dispose()}))},n.prototype.setUserId=function(t){this.userRef_&&(this.userRef_.child("cursor").remove(),this.userRef_.child("cursor").onDisconnect().cancel(),this.userRef_.child("color").remove(),this.userRef_.child("color").onDisconnect().cancel()),this.userId_=t,this.userRef_=this.ref_.child("users").child(t),this.initializeUserData_()},n.prototype.isHistoryEmpty=function(){return s(this.ready_,"Not ready yet."),0===this.revision_},n.prototype.sendOperation=function(t,e){var r=this;if(this.ready_){s(this.document_.targetLength===t.baseLength,"sendOperation() called with invalid operation.");var i=h(this.revision_);this.sent_={id:i,op:t},function t(i,n){r.ref_.child("history").child(i).transaction((function(t){if(null===t)return n}),(function(s,a,h){if(s){if("disconnect"!==s.message)throw o.log("Transaction failure!",s),s;r.sent_&&r.sent_.id===i?setTimeout((function(){t(i,n)}),0):e&&e(s,!1)}else e&&e(null,a)}),!1)}(i,{a:r.userId_,o:t.toJSON(),t:firebase.database.ServerValue.TIMESTAMP})}else this.on("ready",(function(){r.trigger("retry")}))},n.prototype.sendCursor=function(t){this.userRef_.child("cursor").set(t),this.cursor_=t},n.prototype.setColor=function(t){this.userRef_.child("color").set(t),this.color_=t},n.prototype.getDocument=function(){return this.document_},n.prototype.registerCallbacks=function(t){for(var e in t)this.on(e,t[e])},n.prototype.initializeUserData_=function(){this.userRef_.child("cursor").onDisconnect().remove(),this.userRef_.child("color").onDisconnect().remove(),this.sendCursor(this.cursor_||null),this.setColor(this.color_||null)},n.prototype.monitorCursors_=function(){var t=this.ref_.child("users"),e=this;function r(t){var r=t.key,i=t.val();e.trigger("cursor",r,i.cursor,i.color)}this.firebaseOn_(t,"child_added",r),this.firebaseOn_(t,"child_changed",r),this.firebaseOn_(t,"child_removed",(function(t){var r=t.key;e.trigger("cursor",r,null)}))},n.prototype.monitorHistory_=function(){var t=this;this.ref_.child("checkpoint").once("value",(function(e){if(!t.zombie_){var r=e.child("id").val(),i=e.child("o").val(),o=e.child("a").val();null!=i&&null!=r&&null!==o?(t.pendingReceivedRevisions_[r]={o:i,a:o},t.checkpointRevision_=function(t){s(t.length>0&&t[0]===a[t.length+8]);for(var e=0,r=1;r<t.length;r++)e*=a.length,e+=a.indexOf(t[r]);return e}(r),t.monitorHistoryStartingAt_(t.checkpointRevision_+1)):(t.checkpointRevision_=0,t.monitorHistoryStartingAt_(t.checkpointRevision_))}}))},n.prototype.monitorHistoryStartingAt_=function(t){var e=this.ref_.child("history").startAt(null,h(t)),r=this;setTimeout((function(){r.firebaseOn_(e,"child_added",(function(t){var e=t.key;r.pendingReceivedRevisions_[e]=t.val(),r.ready_&&r.handlePendingReceivedRevisions_()})),e.once("value",(function(){r.handleInitialRevisions_()}))}),0)},n.prototype.handleInitialRevisions_=function(){s(!this.ready_,"Should not be called multiple times."),this.revision_=this.checkpointRevision_;for(var t=h(this.revision_),e=this.pendingReceivedRevisions_;null!=e[t];){var r=this.parseRevision_(e[t]);r?this.document_=this.document_.compose(r.operation):o.log("Invalid operation.",this.ref_.toString(),t,e[t]),delete e[t],this.revision_++,t=h(this.revision_)}this.trigger("operation",this.document_),this.ready_=!0;var i=this;setTimeout((function(){i.trigger("ready")}),0)},n.prototype.handlePendingReceivedRevisions_=function(){for(var t=this.pendingReceivedRevisions_,e=h(this.revision_),r=!1;null!=t[e];){this.revision_++;var i=this.parseRevision_(t[e]);i?(this.document_=this.document_.compose(i.operation),this.sent_&&e===this.sent_.id?this.sent_.op.equals(i.operation)&&i.author===this.userId_?(this.revision_%100==0&&this.saveCheckpoint_(),this.sent_=null,this.trigger("ack")):(r=!0,this.trigger("operation",i.operation)):this.trigger("operation",i.operation)):o.log("Invalid operation.",this.ref_.toString(),e,t[e]),delete t[e],e=h(this.revision_)}r&&(this.sent_=null,this.trigger("retry"))},n.prototype.parseRevision_=function(t){if("object"!=typeof t)return null;if("string"!=typeof t.a||"object"!=typeof t.o)return null;var e=null;try{e=i.fromJSON(t.o)}catch(t){return null}return e.baseLength!==this.document_.targetLength?null:{author:t.a,operation:e}},n.prototype.saveCheckpoint_=function(){this.ref_.child("checkpoint").set({a:this.userId_,o:this.document_.toJSON(),id:h(this.revision_-1)})},n.prototype.firebaseOn_=function(t,e,r,i){return this.firebaseCallbacks_.push({ref:t,eventType:e,callback:r,context:i}),t.on(e,r,i),r},n.prototype.firebaseOff_=function(t,e,r,i){t.off(e,r,i);for(var o=0;o<this.firebaseCallbacks_.length;o++){var n=this.firebaseCallbacks_[o];if(n.ref===t&&n.eventType===e&&n.callback===r&&n.context===i){this.firebaseCallbacks_.splice(o,1);break}}},n.prototype.removeFirebaseCallbacks_=function(){for(var t=0;t<this.firebaseCallbacks_.length;t++){var e=this.firebaseCallbacks_[t];e.ref.off(e.eventType,e.callback,e.context)}this.firebaseCallbacks_=[]};var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function h(t){if(0===t)return"A0";for(var e="";t>0;){var r=t%a.length;e=a[r]+e,t-=r,t/=a.length}return a[e.length+9]+e}return n}(),(t=t||{}).WrappedOperation=function(t){"use strict";function e(t,e){this.wrapped=t,this.meta=e}function r(t,e){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}function i(t,e){return t&&"object"==typeof t&&"function"==typeof t.transform?t.transform(e):t}return e.prototype.apply=function(){return this.wrapped.apply.apply(this.wrapped,arguments)},e.prototype.invert=function(){var t=this.meta;return new e(this.wrapped.invert.apply(this.wrapped,arguments),t&&"object"==typeof t&&"function"==typeof t.invert?t.invert.apply(t,arguments):t)},e.prototype.compose=function(t){return new e(this.wrapped.compose(t.wrapped),function(t,e){if(t&&"object"==typeof t){if("function"==typeof t.compose)return t.compose(e);var i={};return r(t,i),r(e,i),i}return e}(this.meta,t.meta))},e.transform=function(t,r){var o=t.wrapped.transform(r.wrapped);return[new e(o[0],i(t.meta,r.wrapped)),new e(o[1],i(r.meta,t.wrapped))]},e.prototype.transform=function(t){return e.transform(this,t)},e}(),(t=t||{}).UndoManager=function(){"use strict";function t(t){this.maxItems=t||50,this.state="normal",this.dontCompose=!1,this.undoStack=[],this.redoStack=[]}function e(t,e){for(var r=[],i=e.constructor,o=t.length-1;o>=0;o--){var n=i.transform(t[o],e);"function"==typeof n[0].isNoop&&n[0].isNoop()||r.push(n[0]),e=n[1]}return r.reverse()}return t.prototype.add=function(t,e){if("undoing"===this.state)this.redoStack.push(t),this.dontCompose=!0;else if("redoing"===this.state)this.undoStack.push(t),this.dontCompose=!0;else{var r=this.undoStack;!this.dontCompose&&e&&r.length>0?r.push(t.compose(r.pop())):(r.push(t),r.length>this.maxItems&&r.shift()),this.dontCompose=!1,this.redoStack=[]}},t.prototype.transform=function(t){this.undoStack=e(this.undoStack,t),this.redoStack=e(this.redoStack,t)},t.prototype.performUndo=function(t){if(this.state="undoing",0===this.undoStack.length)throw new Error("undo not possible");t(this.undoStack.pop()),this.state="normal"},t.prototype.performRedo=function(t){if(this.state="redoing",0===this.redoStack.length)throw new Error("redo not possible");t(this.redoStack.pop()),this.state="normal"},t.prototype.canUndo=function(){return 0!==this.undoStack.length},t.prototype.canRedo=function(){return 0!==this.redoStack.length},t.prototype.isUndoing=function(){return"undoing"===this.state},t.prototype.isRedoing=function(){return"redoing"===this.state},t}(),(t=t||{}).Client=function(){"use strict";function t(){this.state=r}function e(){}t.prototype.setState=function(t){this.state=t},t.prototype.applyClient=function(t){this.setState(this.state.applyClient(this,t))},t.prototype.applyServer=function(t){this.setState(this.state.applyServer(this,t))},t.prototype.serverAck=function(){this.setState(this.state.serverAck(this))},t.prototype.serverRetry=function(){this.setState(this.state.serverRetry(this))},t.prototype.sendOperation=function(t){throw new Error("sendOperation must be defined in child class")},t.prototype.applyOperation=function(t){throw new Error("applyOperation must be defined in child class")},t.Synchronized=e,e.prototype.applyClient=function(t,e){return t.sendOperation(e),new i(e)},e.prototype.applyServer=function(t,e){return t.applyOperation(e),this},e.prototype.serverAck=function(t){throw new Error("There is no pending operation.")},e.prototype.serverRetry=function(t){throw new Error("There is no pending operation.")};var r=new e;function i(t){this.outstanding=t}function o(t,e){this.outstanding=t,this.buffer=e}return t.AwaitingConfirm=i,i.prototype.applyClient=function(t,e){return new o(this.outstanding,e)},i.prototype.applyServer=function(t,e){var r=this.outstanding.transform(e);return t.applyOperation(r[1]),new i(r[0])},i.prototype.serverAck=function(t){return r},i.prototype.serverRetry=function(t){return t.sendOperation(this.outstanding),this},t.AwaitingWithBuffer=o,o.prototype.applyClient=function(t,e){var r=this.buffer.compose(e);return new o(this.outstanding,r)},o.prototype.applyServer=function(t,e){var r=this.outstanding.transform(e),i=this.buffer.transform(r[1]);return t.applyOperation(i[1]),new o(r[0],i[0])},o.prototype.serverRetry=function(t){var e=this.outstanding.compose(this.buffer);return t.sendOperation(e),new i(e)},o.prototype.serverAck=function(t){return t.sendOperation(this.buffer),new i(this.buffer)},t}(),(t=t||{}).EditorClient=function(){"use strict";var e=t.Client,r=t.Cursor,i=t.UndoManager,o=t.WrappedOperation;function n(t,e){this.cursorBefore=t,this.cursorAfter=e}function s(t,e){this.id=t,this.editorAdapter=e}function a(t,o){e.call(this),this.serverAdapter=t,this.editorAdapter=o,this.undoManager=new i,this.clients={};var n=this;this.editorAdapter.registerCallbacks({change:function(t,e){n.onChange(t,e)},cursorActivity:function(){n.onCursorActivity()},blur:function(){n.onBlur()},focus:function(){n.onFocus()}}),this.editorAdapter.registerUndo((function(){n.undo()})),this.editorAdapter.registerRedo((function(){n.redo()})),this.serverAdapter.registerCallbacks({ack:function(){n.serverAck(),n.focused&&n.state instanceof e.Synchronized&&(n.updateCursor(),n.sendCursor(n.cursor)),n.emitStatus()},retry:function(){n.serverRetry()},operation:function(t){n.applyServer(t)},cursor:function(t,i,o){if(n.serverAdapter.userId_!==t&&n.state instanceof e.Synchronized){var s=n.getClientObject(t);i?(o&&s.setColor(o),s.updateCursor(r.fromJSON(i))):s.removeCursor()}}})}return n.prototype.invert=function(){return new n(this.cursorAfter,this.cursorBefore)},n.prototype.compose=function(t){return new n(this.cursorBefore,t.cursorAfter)},n.prototype.transform=function(t){return new n(this.cursorBefore?this.cursorBefore.transform(t):null,this.cursorAfter?this.cursorAfter.transform(t):null)},s.prototype.setColor=function(t){this.color=t},s.prototype.updateCursor=function(t){this.removeCursor(),this.cursor=t,this.mark=this.editorAdapter.setOtherCursor(t,this.color,this.id)},s.prototype.removeCursor=function(){this.mark&&this.mark.clear()},function(t,e){function r(){}r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}(a,e),a.prototype.getClientObject=function(t){var e=this.clients[t];return e||(this.clients[t]=new s(t,this.editorAdapter))},a.prototype.applyUnredo=function(t){this.undoManager.add(this.editorAdapter.invertOperation(t)),this.editorAdapter.applyOperation(t.wrapped),this.cursor=t.meta.cursorAfter,this.cursor&&this.editorAdapter.setCursor(this.cursor),this.applyClient(t.wrapped)},a.prototype.undo=function(){var t=this;this.undoManager.canUndo()&&this.undoManager.performUndo((function(e){t.applyUnredo(e)}))},a.prototype.redo=function(){var t=this;this.undoManager.canRedo()&&this.undoManager.performRedo((function(e){t.applyUnredo(e)}))},a.prototype.onChange=function(t,e){var r=this.cursor;this.updateCursor();var i,s=this.undoManager.undoStack.length>0&&e.shouldBeComposedWithInverted((i=this.undoManager.undoStack,i[i.length-1]).wrapped),a=new n(this.cursor,r);this.undoManager.add(new o(e,a),s),this.applyClient(t)},a.prototype.updateCursor=function(){this.cursor=this.editorAdapter.getCursor()},a.prototype.onCursorActivity=function(){var t=this.cursor;this.updateCursor(),!this.focused||t&&this.cursor.equals(t)||this.sendCursor(this.cursor)},a.prototype.onBlur=function(){this.cursor=null,this.sendCursor(null),this.focused=!1},a.prototype.onFocus=function(){this.focused=!0,this.onCursorActivity()},a.prototype.sendCursor=function(t){this.state instanceof e.AwaitingWithBuffer||this.serverAdapter.sendCursor(t)},a.prototype.sendOperation=function(t){this.serverAdapter.sendOperation(t),this.emitStatus()},a.prototype.applyOperation=function(t){this.editorAdapter.applyOperation(t),this.updateCursor(),this.undoManager.transform(new o(t,null))},a.prototype.emitStatus=function(){var t=this;setTimeout((function(){t.trigger("synced",t.state instanceof e.Synchronized)}),0)},a}(),t.utils.makeEventEmitter(t.EditorClient,["synced"]);var t,e=function(t,e,r){return"."+t+" {\n  position: relative;\nbackground-color: "+e+";\nborder-left: 2px solid "+r+";\n}"},i=function(t,e){if("undefined"==typeof document||null===document)return!1;if(-1===this.addedStyleRules.indexOf(t)){var r=document.createElement("style"),i=document.createTextNode(e);r.appendChild(i),document.head.appendChild(r),this.addedStyleRules.push(t)}},o=function(){function r(t){if(!t||"function"!=typeof t.getModel)throw new Error("MonacoAdapter: Incorrect Parameter Recieved in constructor, expected valid Monaco Instance");this.monaco=t,this.monacoModel=this.monaco.getModel(),this.lastDocLines=this.monacoModel.getLinesContent(),this.lastCursorRange=this.monaco.getSelection(),this.callbacks={},this.otherCursors=[],this.addedStyleRules=[],this.ignoreChanges=!1,this.onChange=this.onChange.bind(this),this.onBlur=this.onBlur.bind(this),this.onFocus=this.onFocus.bind(this),this.onCursorActivity=this.onCursorActivity.bind(this),this.changeHandler=this.monaco.onDidChangeModelContent(this.onChange),this.didBlurHandler=this.monaco.onDidBlurEditorWidget(this.onBlur),this.didFocusHandler=this.monaco.onDidFocusEditorWidget(this.onFocus),this.didChangeCursorPositionHandler=this.monaco.onDidChangeCursorPosition(this.onCursorActivity)}return r.prototype.detach=function(){this.changeHandler.dispose(),this.didBlurHandler.dispose(),this.didFocusHandler.dispose(),this.didChangeCursorPositionHandler.dispose()},r.prototype.getCursor=function(){var e=this.monaco.getSelection();null==e&&(e=this.lastCursorRange);var r=e.getStartPosition(),i=e.getEndPosition(),o=this.monacoModel.getOffsetAt(r),n=this.monacoModel.getOffsetAt(i);if(o>n){var s=[n,o];o=s[0],n=s[1]}return new t.Cursor(o,n)},r.prototype.setCursor=function(t){var e=t.position,r=t.selectionEnd,i=this.monacoModel.getPositionAt(e),o=this.monacoModel.getPositionAt(r);if(e>r){var n=[o,i];i=n[0],o=n[1]}this.monaco.setSelection(new monaco.Range(i.lineNumber,i.column,o.lineNumber,o.column))},r.prototype.setOtherCursor=function(t,r,o){if("object"!=typeof t||"number"!=typeof t.position||"number"!=typeof t.selectionEnd)return!1;if("string"!=typeof r||!r.match(/^#[a-fA-F0-9]{3,6}$/))return!1;var n=t.position,s=t.selectionEnd;if(n<0||s<0)return!1;var a=this.otherCursors.find((function(t){return t.clientID===o}));a||(a={clientID:o,decoration:[]},this.otherCursors.push(a)),a.decoration=this.monaco.deltaDecorations(a.decoration,[]);var h,c,p="other-client-selection-"+r.replace("#","");n===s?(p=p.replace("selection","cursor"),h=e(p,"transparent",r),c=i.call(this,p,h)):(h=e(p,r,r),c=i.call(this,p,h)),0==c&&console.log("Monaco Adapter: Failed to add some css style.\nPlease make sure you're running on supported environment.");var u=this.monacoModel.getPositionAt(n),l=this.monacoModel.getPositionAt(s);if(n>s){var d=[l,u];u=d[0],l=d[1]}a.decoration=this.monaco.deltaDecorations(a.decoration,[{range:new monaco.Range(u.lineNumber,u.column,l.lineNumber,l.column),options:{className:p}}]);var f=this;return{clear:function(){a.decoration=f.monaco.deltaDecorations(a.decoration,[])}}},r.prototype.registerCallbacks=function(t){this.callbacks=Object.assign({},this.callbacks,t)},r.prototype.registerUndo=function(t){if("function"!=typeof t)throw new Error("MonacoAdapter: registerUndo method expects a callback function in parameter");this.callbacks.undo=t},r.prototype.registerRedo=function(t){if("function"!=typeof t)throw new Error("MonacoAdapter: registerRedo method expects a callback function in parameter");this.callbacks.redo=t},r.prototype.operationFromMonacoChanges=function(e,r,i){var o,n,s,a=e.text,h=e.rangeLength,c=e.rangeOffset+i,p=r.length+i-c;return 0===a.length&&h>0?(s=r.slice(c,c+h),o=(new t.TextOperation).retain(c).delete(h).retain(p-h),n=(new t.TextOperation).retain(c).insert(s).retain(p-h)):a.length>0&&h>0?(s=r.slice(c,c+h),o=(new t.TextOperation).retain(c).delete(h).insert(a).retain(p-h),n=(new t.TextOperation).retain(c).delete(a.length).insert(s).retain(p-h)):(o=(new t.TextOperation).retain(c).insert(a).retain(p),n=(new t.TextOperation).retain(c).delete(a).retain(p)),[o,n]},r.prototype.onChange=function(e){var r=this;if(!this.ignoreChanges){var i=this.lastDocLines.join(this.monacoModel.getEOL()),o=0;if(!e.changes){var n=(new t.TextOperation).retain(i.length);this.trigger("change",n,n)}e.changes.reverse().forEach((function(t){var e=r.operationFromMonacoChanges(t,i,o);o+=e[0].targetLength-e[0].baseLength,r.trigger.apply(r,["change"].concat(e))})),this.lastDocLines=this.monacoModel.getLinesContent()}},r.prototype.trigger=function(t){if(this.callbacks.hasOwnProperty(t)){var e=this.callbacks[t],r=[];if(arguments.length>1)for(var i=1;i<arguments.length;i++)r.push(arguments[i]);e.apply(null,r)}},r.prototype.onBlur=function(){this.monaco.getSelection().isEmpty()&&this.trigger("blur")},r.prototype.onFocus=function(){this.trigger("focus")},r.prototype.onCursorActivity=function(){var t=this;setTimeout((function(){return t.trigger("cursorActivity")}),1)},r.prototype.applyOperation=function(t){t.isNoop()||(this.ignoreChanges=!0);var e=t.ops,r=0,i=this;e.forEach((function(t){if(t.isRetain())r+=t.chars;else if(t.isInsert()){var e=i.monacoModel.getPositionAt(r);i.monaco.executeEdits("my-source",[{range:new monaco.Range(e.lineNumber,e.column,e.lineNumber,e.column),text:t.text,forceMoveMarkers:!0}]),r+=t.text.length}else if(t.isDelete()){var o=i.monacoModel.getPositionAt(r),n=i.monacoModel.getPositionAt(r+t.chars);i.monaco.executeEdits("my-source",[{range:new monaco.Range(o.lineNumber,o.column,n.lineNumber,n.column),text:"",forceMoveMarkers:!0}])}})),this.lastDocLines=this.monacoModel.getLinesContent(),this.ignoreChanges=!1},r.prototype.invertOperation=function(t){t.invert(this.getValue())},r}();return t.MonacoAdapter=o,(t=t||{}).textPiecesToInserts=function(e,r){var i=[];function o(r,o){r instanceof t.Text&&(o=r.formatting.attributes,r=r.text),i.push({string:r,attributes:o}),e="\n"===r[r.length-1]}function n(r,i){e&&o(t.sentinelConstants.LINE_SENTINEL_CHARACTER,r.formatting.attributes);for(var n=0;n<r.textPieces.length;n++)o(r.textPieces[n]);i&&o("\n")}for(var s=0;s<r.length;s++)r[s]instanceof t.Line?n(r[s],s<r.length-1):o(r[s]);return i},(t=t||{}).Firepad=function(e){var r=t.RichTextCodeMirrorAdapter,i=t.RichTextCodeMirror,o=t.RichTextToolbar,n=t.ACEAdapter,s=t.MonacoAdapter,a=t.FirebaseAdapter,h=t.EditorClient,c=t.utils,p=e.CodeMirror,u=e.ace;function l(t,o,f){if(!(this instanceof l))return new l(t,o,f);if(!p&&!u&&!e.monaco)throw new Error("Couldn't find CodeMirror, ACE or Monaco.  Did you forget to include codemirror.js/ace.js or import monaco?");if(this.zombie_=!1,p&&o instanceof p){this.codeMirror_=this.editor_=o;var g=this.codeMirror_.getValue();if(""!==g)throw new Error("Can't initialize Firepad with a CodeMirror instance that already contains text.")}else if(u&&o&&o.session instanceof u.EditSession){if(this.ace_=this.editor_=o,""!==(g=this.ace_.getValue()))throw new Error("Can't initialize Firepad with an ACE instance that already contains text.")}else if(e.monaco&&o&&o instanceof e.monaco.constructor){if(e.monaco,this.monaco_=this.editor_=o,""!==(g=this.monaco_.getValue()))throw new Error("Can't initialize Firepad with a Monaco instance that already contains text.")}else this.codeMirror_=this.editor_=new p(o);var y;y=this.codeMirror_?this.codeMirror_.getWrapperElement():this.ace_?this.ace_.container:this.monaco_.getDomNode(),this.firepadWrapper_=c.elt("div",null,{class:"firepad"}),y.parentNode.replaceChild(this.firepadWrapper_,y),this.firepadWrapper_.appendChild(y),c.on(y,"dragstart",c.stopEvent),this.editor_.firepad=this,this.options_=f||{},this.getOption("richTextShortcuts",!1)&&(p.keyMap.richtext||this.initializeKeyMap_(),this.codeMirror_.setOption("keyMap","richtext"),this.firepadWrapper_.className+=" firepad-richtext"),this.imageInsertionUI=this.getOption("imageInsertionUI",!0),this.getOption("richTextToolbar",!1)&&(this.addToolbar_(),this.firepadWrapper_.className+=" firepad-richtext firepad-with-toolbar"),this.codeMirror_&&this.codeMirror_.refresh();var v=this.getOption("userId",t.push().key),m=this.getOption("userColor",function(t){for(var e=1,r=0;r<t.length;r++)e=17*(e+t.charCodeAt(r))%360;return function(t,e,r){if(0===e)return d(r,r,r);var i=r<.5?r*(1+e):r+e-e*r,o=2*r-i,n=function(t){return t<0&&(t+=1),t>1&&(t-=1),6*t<1?o+6*(i-o)*t:2*t<1?i:3*t<2?o+6*(i-o)*(2/3-t):o};return d(n(t+1/3),n(t),n(t-1/3))}(e/360,1,.75)}(v));this.firebaseAdapter_=new a(t,v,m),this.codeMirror_?(this.richTextCodeMirror_=new i(this.codeMirror_,this.entityManager_,{cssPrefix:"firepad-"}),this.editorAdapter_=new r(this.richTextCodeMirror_)):this.ace_?this.editorAdapter_=new n(this.ace_):this.editorAdapter_=new s(this.monaco_),this.client_=new h(this.firebaseAdapter_,this.editorAdapter_);var _=this;this.firebaseAdapter_.on("cursor",(function(){_.trigger.apply(_,["cursor"].concat([].slice.call(arguments)))})),this.codeMirror_&&this.richTextCodeMirror_.on("newLine",(function(){_.trigger.apply(_,["newLine"].concat([].slice.call(arguments)))})),this.firebaseAdapter_.on("ready",(function(){_.ready_=!0,this.ace_&&this.editorAdapter_.grabDocumentState(),this.monaco_&&this.editorAdapter_.grabDocumentState();var t=_.getOption("defaultText",null);t&&_.isHistoryEmpty()&&_.setText(t),_.trigger("ready")})),this.client_.on("synced",(function(t){_.trigger("synced",t)})),"Microsoft Internet Explorer"==navigator.appName&&navigator.userAgent.match(/MSIE 8\./)&&(window.onload=function(){var t=document.getElementsByTagName("head")[0],e=document.createElement("style");e.type="text/css",e.styleSheet.cssText=":before,:after{content:none !important;}",t.appendChild(e),setTimeout((function(){t.removeChild(e)}),0)})}function d(t,e,r){function i(t){var e=Math.round(255*t).toString(16);return 1===e.length?"0"+e:e}return"#"+i(t)+i(e)+i(r)}return e.monaco,c.makeEventEmitter(l),l.fromCodeMirror=l,l.fromACE=l,l.fromMonaco=l,l.prototype.dispose=function(){this.zombie_=!0,this.codeMirror_?editorWrapper=this.codeMirror_.getWrapperElement():this.ace_?editorWrapper=this.ace_.container:editorWrapper=this.monaco_.getDomNode(),this.firepadWrapper_.removeChild(editorWrapper),this.firepadWrapper_.parentNode.replaceChild(editorWrapper,this.firepadWrapper_),this.editor_.firepad=null,this.codeMirror_&&"richtext"===this.codeMirror_.getOption("keyMap")&&this.codeMirror_.setOption("keyMap","default"),this.firebaseAdapter_.dispose(),this.editorAdapter_.detach(),this.richTextCodeMirror_&&this.richTextCodeMirror_.detach()},l.prototype.setUserId=function(t){this.firebaseAdapter_.setUserId(t)},l.prototype.setUserColor=function(t){this.firebaseAdapter_.setColor(t)},l.prototype.getText=function(){return this.assertReady_("getText"),this.codeMirror_?this.richTextCodeMirror_.getText():this.ace_?this.ace_.getSession().getDocument().getValue():this.monaco_.getModel().getValue()},l.prototype.setText=function(t){return this.assertReady_("setText"),this.monaco_?this.monaco_.getModel().setValue(t):this.ace_?this.ace_.getSession().getDocument().setValue(t):(this.codeMirror_.getWrapperElement().setAttribute("style","display: none"),this.codeMirror_.setValue(""),this.insertText(0,t),this.codeMirror_.getWrapperElement().setAttribute("style",""),this.codeMirror_.refresh(),void this.editorAdapter_.setCursor({position:0,selectionEnd:0}))},l.prototype.insertTextAtCursor=function(t){this.insertText(this.codeMirror_.indexFromPos(this.codeMirror_.getCursor()),t)},l.prototype.insertText=function(e,r){c.assert(!this.ace_,"Not supported for ace yet."),c.assert(!this.monaco_,"Not supported for monaco yet."),this.assertReady_("insertText"),"[object Array]"!==Object.prototype.toString.call(r)&&(r=[r]);var i=this;i.codeMirror_.operation((function(){for(var o=0===e,n=t.textPiecesToInserts(o,r),s=0;s<n.length;s++){var a=n[s].string,h=n[s].attributes;i.richTextCodeMirror_.insertText(e,a,h),e+=a.length}}))},l.prototype.getOperationForSpan=function(e,r){for(var i=this.richTextCodeMirror_.getRange(e,r),o=this.richTextCodeMirror_.getAttributeSpans(e,r),n=0,s=new t.TextOperation,a=0;a<o.length;a++)s.insert(i.substr(n,o[a].length),o[a].attributes),n+=o[a].length;return s},l.prototype.getHtml=function(){return this.getHtmlFromRange(null,null)},l.prototype.getHtmlFromSelection=function(){var t=this.codeMirror_.getCursor("start"),e=this.codeMirror_.getCursor("end"),r=this.codeMirror_.indexFromPos(t),i=this.codeMirror_.indexFromPos(e);return this.getHtmlFromRange(r,i)},l.prototype.getHtmlFromRange=function(e,r){this.assertReady_("getHtmlFromRange");var i=null!=e&&null!=r?this.getOperationForSpan(e,r):this.getOperationForSpan(0,this.codeMirror_.getValue().length);return t.SerializeHtml(i,this.entityManager_)},l.prototype.insertHtml=function(e,r){var i=t.ParseHtml(r,this.entityManager_);this.insertText(e,i)},l.prototype.insertHtmlAtCursor=function(t){this.insertHtml(this.codeMirror_.indexFromPos(this.codeMirror_.getCursor()),t)},l.prototype.setHtml=function(e){var r=t.ParseHtml(e,this.entityManager_);this.setText(r)},l.prototype.isHistoryEmpty=function(){return this.assertReady_("isHistoryEmpty"),this.firebaseAdapter_.isHistoryEmpty()},l.prototype.bold=function(){this.richTextCodeMirror_.toggleAttribute(ATTR.BOLD),this.codeMirror_.focus()},l.prototype.italic=function(){this.richTextCodeMirror_.toggleAttribute(ATTR.ITALIC),this.codeMirror_.focus()},l.prototype.underline=function(){this.richTextCodeMirror_.toggleAttribute(ATTR.UNDERLINE),this.codeMirror_.focus()},l.prototype.strike=function(){this.richTextCodeMirror_.toggleAttribute(ATTR.STRIKE),this.codeMirror_.focus()},l.prototype.fontSize=function(t){this.richTextCodeMirror_.setAttribute(ATTR.FONT_SIZE,t),this.codeMirror_.focus()},l.prototype.font=function(t){this.richTextCodeMirror_.setAttribute(ATTR.FONT,t),this.codeMirror_.focus()},l.prototype.color=function(t){this.richTextCodeMirror_.setAttribute(ATTR.COLOR,t),this.codeMirror_.focus()},l.prototype.highlight=function(){this.richTextCodeMirror_.toggleAttribute(ATTR.BACKGROUND_COLOR,"rgba(255,255,0,.65)"),this.codeMirror_.focus()},l.prototype.align=function(t){if("left"!==t&&"center"!==t&&"right"!==t)throw new Error('align() must be passed "left", "center", or "right".');this.richTextCodeMirror_.setLineAttribute(ATTR.LINE_ALIGN,t),this.codeMirror_.focus()},l.prototype.orderedList=function(){this.richTextCodeMirror_.toggleLineAttribute(ATTR.LIST_TYPE,"o"),this.codeMirror_.focus()},l.prototype.unorderedList=function(){this.richTextCodeMirror_.toggleLineAttribute(ATTR.LIST_TYPE,"u"),this.codeMirror_.focus()},l.prototype.todo=function(){this.richTextCodeMirror_.toggleTodo(),this.codeMirror_.focus()},l.prototype.newline=function(){this.richTextCodeMirror_.newline()},l.prototype.deleteLeft=function(){this.richTextCodeMirror_.deleteLeft()},l.prototype.deleteRight=function(){this.richTextCodeMirror_.deleteRight()},l.prototype.indent=function(){this.richTextCodeMirror_.indent(),this.codeMirror_.focus()},l.prototype.unindent=function(){this.richTextCodeMirror_.unindent(),this.codeMirror_.focus()},l.prototype.undo=function(){this.codeMirror_.undo()},l.prototype.redo=function(){this.codeMirror_.redo()},l.prototype.insertEntity=function(t,e,r){this.richTextCodeMirror_.insertEntityAtCursor(t,e,r)},l.prototype.insertEntityAt=function(t,e,r,i){this.richTextCodeMirror_.insertEntityAt(t,e,r,i)},l.prototype.registerEntity=function(t,e){this.entityManager_.register(t,e)},l.prototype.getOption=function(t,e){return t in this.options_?this.options_[t]:e},l.prototype.assertReady_=function(t){if(!this.ready_)throw new Error('You must wait for the "ready" event before calling '+t+".");if(this.zombie_)throw new Error("You can't use a Firepad after calling dispose()!  [called "+t+"]")},l.prototype.makeImageDialog_=function(){this.makeDialog_("img","Insert image url")},l.prototype.makeDialog_=function(t,e){var r=this,i=c.elt("input",null,{class:"firepad-dialog-input",id:t,type:"text",placeholder:e,autofocus:"autofocus"}),o=c.elt("a","Submit",{class:"firepad-btn",id:"submitbtn"});c.on(o,"click",c.stopEventAnd((function(){var e=document.getElementById("overlay");e.style.visibility="hidden";var i=document.getElementById(t).value;null!==i&&r.insertEntity(t,{src:i}),r.firepadWrapper_.removeChild(e)})));var n=c.elt("a","Cancel",{class:"firepad-btn"});c.on(n,"click",c.stopEventAnd((function(){var t=document.getElementById("overlay");t.style.visibility="hidden",r.firepadWrapper_.removeChild(t)})));var s=c.elt("div",[o,n],{class:"firepad-btn-group"}),a=c.elt("div",[i,s],{class:"firepad-dialog-div"}),h=c.elt("div",[a],{class:"firepad-dialog",id:"overlay"});this.firepadWrapper_.appendChild(h)},l.prototype.addToolbar_=function(){this.toolbar=new o(this.imageInsertionUI),this.toolbar.on("undo",this.undo,this),this.toolbar.on("redo",this.redo,this),this.toolbar.on("bold",this.bold,this),this.toolbar.on("italic",this.italic,this),this.toolbar.on("underline",this.underline,this),this.toolbar.on("strike",this.strike,this),this.toolbar.on("font-size",this.fontSize,this),this.toolbar.on("font",this.font,this),this.toolbar.on("color",this.color,this),this.toolbar.on("left",(function(){this.align("left")}),this),this.toolbar.on("center",(function(){this.align("center")}),this),this.toolbar.on("right",(function(){this.align("right")}),this),this.toolbar.on("ordered-list",this.orderedList,this),this.toolbar.on("unordered-list",this.unorderedList,this),this.toolbar.on("todo-list",this.todo,this),this.toolbar.on("indent-increase",this.indent,this),this.toolbar.on("indent-decrease",this.unindent,this),this.toolbar.on("insert-image",this.makeImageDialog_,this),this.firepadWrapper_.insertBefore(this.toolbar.element(),this.firepadWrapper_.firstChild)},l.prototype.addPoweredByLogo_=function(){var t=c.elt("a",null,{class:"powered-by-firepad"});t.setAttribute("href","http://www.firepad.io/"),t.setAttribute("target","_blank"),this.firepadWrapper_.appendChild(t)},l.prototype.initializeKeyMap_=function(){function t(t){return function(e){setTimeout((function(){t.call(e.firepad)}),0)}}p.keyMap.richtext={"Ctrl-B":t(this.bold),"Cmd-B":t(this.bold),"Ctrl-I":t(this.italic),"Cmd-I":t(this.italic),"Ctrl-U":t(this.underline),"Cmd-U":t(this.underline),"Ctrl-H":t(this.highlight),"Cmd-H":t(this.highlight),Enter:t(this.newline),Delete:t(this.deleteRight),Backspace:t(this.deleteLeft),Tab:t(this.indent),"Shift-Tab":t(this.unindent),fallthrough:["default"]}},l}(this),t.Firepad.Formatting=t.Formatting,t.Firepad.Text=t.Text,t.Firepad.Entity=t.Entity,t.Firepad.LineFormatting=t.LineFormatting,t.Firepad.Line=t.Line,t.Firepad.TextOperation=t.TextOperation,t.Firepad.Headless=t.Headless,t.Firepad.RichTextCodeMirrorAdapter=t.RichTextCodeMirrorAdapter,t.Firepad.ACEAdapter=t.ACEAdapter,t.Firepad.MonacoAdapter=t.MonacoAdapter,t.Firepad},s=this,t.exports?t.exports=n():"function"==typeof s.define&&s.define.amd?void 0===(o="function"==typeof(i=n)?i.call(e,r,e,t):i)||(t.exports=o):s.Firepad=n()},322:function(t,e,r){},349:function(t,e,r){"use strict";r.r(e);var i=r(0),o=r(1),n=r(129),s=r(321);function a(t,e,r){var i;return function(){var o=this,n=arguments,s=function(){i=null,r||t.apply(o,n)},a=r&&!i;clearTimeout(i),i=setTimeout(s,e),a&&t.apply(o,n)}}r(322);function h(t){let e,r,o,n,s;return{c(){e=Object(i.o)("div"),r=Object(i.o)("div"),o=Object(i.I)(),n=Object(i.o)("div"),s=Object(i.o)("iframe"),Object(i.d)(r,"id","editor"),Object(i.d)(r,"class","svelte-ft4gmp"),Object(i.d)(s,"srcdoc",t[1]),Object(i.d)(s,"title","Editor Preview"),Object(i.d)(s,"class","svelte-ft4gmp"),Object(i.d)(n,"id","preview"),Object(i.d)(n,"class","svelte-ft4gmp"),Object(i.d)(e,"class","playground svelte-ft4gmp"),Object(i.L)(e,"hidden",!t[0])},m(a,h){Object(i.v)(a,e,h),Object(i.c)(e,r),t[7](r),Object(i.c)(e,o),Object(i.c)(e,n),Object(i.c)(n,s)},p(t,[r]){2&r&&Object(i.d)(s,"srcdoc",t[1]),1&r&&Object(i.L)(e,"hidden",!t[0])},i:i.z,o:i.z,d(r){r&&Object(i.n)(e),t[7](null)}}}function c(t,e,r){let{isActiveTab:h}=e,{previewHTML:c}=e,{user:p}=e;const u=Object(o.b)();let l,d;const f="<!DOCTYPE html>\n<html>\n<head>\n    <title>Welcome</title>\n</head>\n\n<body>\n    <p>Welcome to this workshop!</p>\n</body>\n</html>";return Object(o.e)(()=>{l=n.editor.create(d,{language:"html",minimap:{enabled:!1}});const t=Object(o.c)("firebase").database().ref(`code/${p.uid}`);s.fromMonaco(t,l,{userId:p.uid,defaultText:f});l.layout(),window.addEventListener("resize",a(()=>{l.layout()},500)),l.getModel().onDidChangeContent(a(t=>{u("updateText",{text:l.getValue()})},500))}),Object(o.a)(()=>{l.layout()}),t.$set=t=>{"isActiveTab"in t&&r(0,h=t.isActiveTab),"previewHTML"in t&&r(1,c=t.previewHTML),"user"in t&&r(3,p=t.user)},[h,c,d,p,l,u,f,function(t){i.e[t?"unshift":"push"](()=>{r(2,d=t)})}]}class p extends i.a{constructor(t){super(),Object(i.u)(this,t,c,h,i.E,{isActiveTab:0,previewHTML:1,user:3})}}e.default=p}}]);